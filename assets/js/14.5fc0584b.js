(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{472:function(s,t,a){"use strict";a.r(t);var e=a(65),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" docker-compose")]),s._v(" "),a("ul",[a("li",[s._v("方便统一管理docker镜像与容器,一个配置文件可以配置一组docker容器")]),s._v(" "),a("li",[s._v("并且可以把Dockerfile以及docker run命令跟着的一些容器配置/镜像配置统统写进配置文件中,一目了然又便于管理")])]),s._v(" "),a("h2",{attrs:{id:"dockerfile对应yml配置文件的配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile对应yml配置文件的配置"}},[s._v("#")]),s._v(" Dockerfile对应yml配置文件的配置")]),s._v(" "),a("h3",{attrs:{id:"run"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[s._v("#")]),s._v(" RUN")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Dockerfile中的RUN配置,对应yml中的"),a("strong",[s._v("command")]),s._v("配置")]),s._v(" "),a("div",{staticClass:"language-dockerfile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#为了保证容器时区和系统时区相同，需要挂载docker的/etc/localtime到系统的/etc/localtime。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM是通过/etc/timezone文件获取时区的，需要在容器中映射或者写入时区文件。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Asia/Shanghai"')]),s._v(" > /etc/timezone")]),s._v("\n")])])]),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(' echo "Asia/Shanghai" '),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" /etc/timezone\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"entrypoint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint"}},[s._v("#")]),s._v(" ENTRYPOINT")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Dockerfile中的ENTRYPOINT配置,对应yml中的"),a("strong",[s._v("entrypoint")]),s._v("配置")]),s._v(" "),a("div",{staticClass:"language-dockerfile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Djava.security.egd=file:/dev/./urandom"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-jar"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data/app.jar"')]),s._v("]")]),s._v("\n")])])]),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("entrypoint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Djava.security.egd=file:/dev/./urandom"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-jar"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data/package/app.jar"')]),s._v("\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"from"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#from"}},[s._v("#")]),s._v(" FROM")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Dockerfile中的FROM配置,对应yml中的"),a("strong",[s._v("image")]),s._v("配置")])]),s._v(" "),a("li",[a("p",[s._v("表示使用的镜像,要么是远程dockerhub中的,要么是本地的")]),s._v(" "),a("div",{staticClass:"language-dockerfile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" openjdk:11-jre-slim-buster")]),s._v("\n")])])]),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" esystemstech/libreoffice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("6.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("openjdk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("jdk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("buster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("slim\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"docker-run-命令后跟的配置对应yml配置文件的配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-run-命令后跟的配置对应yml配置文件的配置"}},[s._v("#")]),s._v(" docker run 命令后跟的配置对应yml配置文件的配置")]),s._v(" "),a("h3",{attrs:{id:"p"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#p"}},[s._v("#")]),s._v(" -p")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("docker run命令行中的-p命令,对应yml中的"),a("strong",[s._v("ports")]),s._v("配置")])]),s._v(" "),a("li",[a("p",[s._v("功能为映射容器内外端口号,"),a("strong",[s._v("前方为容器外端口,后方为容器内端口")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("-p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8012")]),s._v(":8082\n")])])]),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8012:8082"')]),s._v("\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"v"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#v"}},[s._v("#")]),s._v(" -v")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("docker run命令行中的-v命令,对应yml中的"),a("strong",[s._v("volumes")]),s._v("配置")])]),s._v(" "),a("li",[a("p",[s._v("功能为映射容器内外目录,"),a("strong",[s._v("前方为容器外目录,后方为容器内目录")]),s._v(",可以用这种方法把容器内的"),a("strong",[s._v("日志/配置文件")]),s._v("同步到容器外目录中便于访问,也可以把容器外"),a("strong",[s._v("jar包/配置文件")]),s._v("同步到容器内使用哦")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("-v /root/shineray/financial-leasing/manage/package:/data\n")])])]),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /D/software/develop/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dir/financial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("leasing/manage/package"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/data/package\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /D/software/develop/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dir/financial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("leasing/manage/cert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/data/cert\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /D/software/develop/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dir/financial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("leasing/manage/pdf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/data/pdf\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#name"}},[s._v("#")]),s._v(" --name")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("docker run命令行中的--name命令,对应yml中的"),a("strong",[s._v("container_name")]),s._v("配置")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("--name financial-leasing-manage\n")])])]),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" financial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("leasing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("manage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pdf\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),a("h3",{attrs:{id:"重启"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启"}},[s._v("#")]),s._v(" 重启")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("docker-compose的重启和docker不一样")]),s._v(",它的重启是重启service名,"),a("code",[s._v("docker-compose restart service名")])])]),s._v(" "),a("li",[a("p",[s._v("也就是配置文件中"),a("code",[s._v("services:")]),s._v("下的一级名称,比如web,这个名称也是我们自己自定义的,一个service下可以有多个容器配置")]),s._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" esystemstech/libreoffice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("6.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("openjdk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("jdk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("buster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("slim\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" financial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("leasing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("manage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pdf\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("h3",{attrs:{id:"docker-compose-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-2"}},[s._v("#")]),s._v(" docker-compose")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("windows系统安装docker桌面版是直接自带docker-compose的,但是linux必须自己去安装")])]),s._v(" "),a("li",[a("p",[s._v("一般服务器都是centos,我们的服务器是centos8版本")])]),s._v(" "),a("li",[a("p",[s._v("网上搜到的教程是先去"),a("code",[s._v("https://github.com/docker/compose/releases/latest")]),s._v("查看最新版本的版本号")])]),s._v(" "),a("li",[a("p",[s._v("然后执行命令安装,如果访问github下载太慢就把链接中的"),a("code",[s._v("https://github.com")]),s._v("更换为"),a("code",[s._v("https://get.daocloud.io")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载最新版本的 docker-compose 到 /usr/bin 目录下,自行修改1.23.2为最新版本号,注意如果版本有v前缀要加上")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L https://github.com/docker/compose/releases/download/1.23.2/docker-compose-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -s"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -m"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" -o /usr/bin/docker-compose\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给 docker-compose 授权")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/bin/docker-compose\n")])])])]),s._v(" "),a("li",[a("p",[s._v("但是这样我失败了,使用对应命令行会报"),a("code",[s._v("/usr/bin/docker-compose: line 1: Not: command not found")])])]),s._v(" "),a("li",[a("p",[s._v("于是经过询问群内大佬得知,需要放到"),a("code",[s._v("/usr/bin")]),s._v("目录下而不是"),a("code",[s._v("/usr/local/bin")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@server01 docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# sudo curl -L "https://github.com/docker/compose/releases/download/v2.6.1/docker-compose-linux-x86_64" -o /usr/bin/docker-compose')]),s._v("\n% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\nDload  Upload   Total   Spent    Left  Speed\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" --:--:-- --:--:-- --:--:--     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(".5M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(".5M    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  4191k      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00:05  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00:05 --:--:-- 5418k\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@server01 docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sudo chmod +x /usr/bin/docker-compose")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@server01 docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose version")]),s._v("\nDocker Compose version v2.6.1\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" docker")]),s._v(" "),a("h4",{attrs:{id:"阿里云安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#阿里云安装"}},[s._v("#")]),s._v(" 阿里云安装")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("服务器是买的阿里云计算型c7,centos7.9版本")])]),s._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.runoob.com/docker/centos-docker-install.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用官方脚本自动安装"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -fsSL https://get.docker.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" -s "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" --mirror Aliyun\n")])])])]),s._v(" "),a("li",[a("p",[s._v("然后安装一切正常,但是如果运行"),a("code",[s._v("docker --version")]),s._v("会报错"),a("code",[s._v("Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?")])])]),s._v(" "),a("li",[a("p",[s._v("这是因为"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_45496075/article/details/109123709",target:"_blank",rel:"noopener noreferrer"}},[s._v("安装完没在系统中启动"),a("OutboundLink")],1),s._v(",只需要运行"),a("code",[s._v("systemctl start docker")]),s._v("即可")])])]),s._v(" "),a("h4",{attrs:{id:"腾讯云安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#腾讯云安装"}},[s._v("#")]),s._v(" 腾讯云安装")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("我在腾讯云服务器使用上面的自动安装脚本失败了"),a("code",[s._v("curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun")])])]),s._v(" "),a("li",[a("p",[s._v("报错信息为"),a("code",[s._v("ERROR: Unsupported distribution 'tencentos'")])])]),s._v(" "),a("li",[a("p",[s._v("登录腾讯云控制台,发现系统为"),a("code",[s._v("TencentOS Server 3.1 (TK4)")]),s._v("版本,该版本已经预置docker")])])]),s._v(" "),a("blockquote",[a("p",[s._v("本文使用云服务器实例操作系统以 CentOS 8.2 及 7.6 为例。\n若您使用了 TencentOS Server 操作系统，则需对应实际版本进行操作：")]),s._v(" "),a("p",[s._v("TencentOS Server 2.4 (TK4)：镜像已预置 Docker，无需再次安装，可参考 使用 Docker 直接开始使用。\nTencentOS Server 3.1：镜像已预置 Docker，无需再次安装，可参考 使用 Docker 直接开始使用。")])]),s._v(" "),a("ul",[a("li",[s._v("只需要按照"),a("a",{attrs:{href:"https://cloud.tencent.com/document/product/213/46000#userDocker",target:"_blank",rel:"noopener noreferrer"}},[s._v("教程"),a("OutboundLink")],1),s._v("使用即可,运行"),a("code",[s._v("systemctl start docker")]),s._v("启动docker")])]),s._v(" "),a("h2",{attrs:{id:"命令-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令-2"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认使用docker-compose.yml构建镜像")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" build\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" build --no-cache "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不带缓存的构建")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定不同yml文件模板用于构建镜像")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" build -f docker-compose1.yml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出Compose文件构建的镜像")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" images            \t              \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动所有编排容器服务")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up -d\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看正在运行中的容器")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有编排容器，包括已停止的容器")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入指定容器执行命令")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" nginx "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" \n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" web python manage.py migrate --noinput\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看web容器的实时日志")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" logs -f web\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止所有up命令启动的容器")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" down \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止所有up命令启动的容器,并移除数据卷")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" down -v\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新启动停止服务的容器")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" restart web\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暂停web容器")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" pause web\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 恢复web容器")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" unpause web\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除web容器，删除前必需停止stop web容器服务")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" web  \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看各个服务容器内运行的进程 ")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v("                            \n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);